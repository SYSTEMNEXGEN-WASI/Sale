@model IEnumerable<Core.CRM.ADO.ViewModel.SalesPersonPerformanceVM>
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_LayoutV2.cshtml";

    int count = 1;

    int LeadsCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().GenerateLeads : 0);
    int ConvertedCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().Converted : 0);
    int LostCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().Lost : 0);
    int FollowUpCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().FollowUp : 0);
    int TaskCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().Task : 0);
    int DOCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().DeliveryOrder : 0);
    int BOCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().BookingOrder : 0);
    int StockCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().Stock : 0);
    int InvoiceCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().Invoice : 0);
    int PICount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().PendingInvoice : 0);
    int PPCount = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().PendingPayment : 0);
    int HoldVehicle = (Model.FirstOrDefault() != null ? Model.FirstOrDefault().TotalHoldVehicle : 0);
}

<style>
    #FollowUpDetail > tr {
        cursor: pointer;
    }

    #FollowUpDetail > td {
        cursor: pointer;
    }

    .h4 {
        font-weight: 700;
    }

    #cover {
        background: url("http://www.aveva.com/Images/ajax-loader.gif") no-repeat scroll center center #FFF;
        position: absolute;
        height: 100%;
        width: 100%;
    }
</style>

<link href="../assets/css/style.css" rel="stylesheet" type="text/css" />
<link href="../assets/css/responsive.css" rel="stylesheet" type="text/css" />
<link href="../assets/plugins/jquery-ui/smoothness/jquery-ui.min.css" rel="stylesheet" type="text/css" media="screen" />
<link href='@Url.Content("~/assets/plugins/daterangepicker/css/daterangepicker-bs3.css")' rel="stylesheet" type="text/css" media="screen" />

<section class="wrapper main-wrapper row" style=''>
    @*<div id="cover"></div>*@
    <div class='col-xs-12'>
        <div class="page-title">

            <div class="pull-left">
                <!-- PAGE HEADING TAG - START --><h1 class="title">Summary</h1><!-- PAGE HEADING TAG - END -->
            </div>
            <div class="hidden-xs" style="margin-left : 260px; margin-top: 10px;">
                <label for="from">From</label>
                <input type="text" id="from" name="from" readonly>
                <label for="to">to</label>
                <input type="text" id="to" name="to" readonly>
                <button type="button" id="btnGetData" onclick="GetData()">Select</button>
            </div>



            @*<div class="pull-right hidden-xs">
                    <label for="startDate">Date :</label>
                    <input name="startDate" id="startDate" class="date-picker" />
                </div>*@

        </div>
    </div>
    <div class="clearfix"></div>
    <!-- MAIN CONTENT AREA STARTS -->


    <div class="col-lg-12">
        <section class="box nobox ">
            <div class="content-body">
                <div class="row">

                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowLeads()">
                            <i class='pull-left fa fa-users icon-md icon-rounded icon-primary'></i>
                            <div class="stats">
                                <label class="h4" id="LeadsCount"><strong>@LeadsCount</strong></label>
                                <span>Leads</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowFollowUps()">
                            <i class='pull-left fa fa-phone-square icon-md icon-rounded icon-warning'></i>
                            <div class="stats">
                                <label class="h4" id="FollowUpCount"><strong>@FollowUpCount</strong></label>
                                <span>FollowUps</span>
                                @*<span ><a id="IssueClick"  style="color:blue; cursor:pointer;display: block; ">Follow Ups</a></span>*@
                                @*<a class="" href='@Url.Action("FollowUp", "Enquiry")'>Follow Ups</a>*@
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowConvertedLeads()">
                            <i class='pull-left fa fa-thumbs-up icon-md icon-rounded icon-success'></i>
                            <div class="stats">
                                <label class="h4" id="ConvertedCount"><strong>@ConvertedCount</strong></label>
                                <span>Converted</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowLosts()">
                            <i class='pull-left fa fa-thumbs-down icon-md icon-rounded icon-accent'></i>
                            <div class="stats">
                                <label class="h4" id="LostCount"><strong>@LostCount</strong></label>
                                <span>Lost</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowBookingOrder()">
                            <i class='pull-left fa fa-book icon-md icon-rounded icon-primary'></i>
                            <div class="stats">
                                <label class="h4" id="BOCount"><strong>@BOCount</strong></label>
                                <span>Booking Orders</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            <i class='pull-left fa fa-home icon-md icon-rounded icon-warning'></i>
                            <div class="stats">
                                <label class="h4" id="StockCount"><strong>@StockCount</strong></label>
                                <span>Stock</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box" style="cursor: pointer;" onclick="ShowDeliveryOrder()">
                            <i class='pull-left fa fa-rocket icon-md icon-rounded icon-success'></i>
                            <div class="stats">
                                <label class="h4" id="DOCount"><strong>@DOCount</strong></label>
                                <span>Delivery Orders</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            <i class='pull-left fa fa-file-o icon-md icon-rounded icon-success'></i>
                            <div class="stats">
                                <label class="h4" id="InvoiceCount"><strong>@InvoiceCount</strong></label>
                                <span>Invoices</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            <i class='pull-left fa fa-file-text icon-md icon-rounded icon-success'></i>
                            <div class="stats">
                                <label class="h4" id="PICount"><strong>@PICount</strong></label>
                                <span>Pending Invoices</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            <i class='pull-left fa fa-money icon-md icon-rounded icon-success'></i>
                            <div class="stats">
                                <label class="h4" id="PPCount"><strong>@PPCount</strong></label>
                                <span>Pending Payment</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            @*<img src="~/assets/images/pending payments.png" class="pull-left fa icon-md icon-rounded icon-primary" />*@
                            <i class='pull-left fa fa-tasks icon-md icon-rounded'></i>
                            <div class="stats">
                                <label class="h4" id="TaskCount"><strong>@TaskCount</strong></label>
                                <span style="white-space: nowrap;">Tasks</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 col-xs-12">
                        <div class="r4_counter db_box">
                            @*<img src="~/assets/images/pending payments.png" class="pull-left fa icon-md icon-rounded icon-primary" />*@
                            <i class='pull-left fa fa-car icon-md icon-rounded'></i>
                            <div class="stats">
                                <label class="h4" id="HoldVehicle"><strong>@HoldVehicle</strong></label>
                                <span style="white-space: nowrap;">Hold Vehicles</span>
                            </div>
                        </div>
                    </div>


                </div>
                <!-- End .row -->


            </div>
        </section>
    </div>

    <div class="modal" tabindex="-1" id="ModalFollowUp" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Follow Ups</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="FollowUpSearch" class="form-control" aria-controls="FollowUpDetail" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="table-responsive" style="height:300px;">
                            <table class="table table-bordered table-striped" id="FollowUpDetail">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Enquiry Id</th>
                                        <th>Enquiry Date</th>
                                        <th>Customer</th>
                                        <th>FollowUp Date</th>
                                        <th>FollowUp Time</th>
                                        <th>Next Action Plan</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- MAIN CONTENT AREA ENDS -->

    <div class="modal" tabindex="-1" id="ModalLeads" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Leads</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="EnquirySearch" class="form-control" aria-controls="EnquiryDetail" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="table-responsive" style="height:300px">
                            <table class="table table-bordered table-striped" id="EnquiryDetail">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Enquiry Id</th>
                                        <th>Enquiry Date</th>
                                        <th>Customer</th>
                                        <th>Cell No</th>
                                        <th>Address</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

    <div class="modal" tabindex="-1" id="ModalConverted" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Converted Leads</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="ConvertedSearch" class="form-control" aria-controls="ConvertedLeadsDetail" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="table-responsive" style="height:300px">
                            <table class="table table-bordered table-striped" id="ConvertedLeadsDetail">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Enquiry Id</th>
                                        <th>Enquiry Date</th>
                                        <th>Customer</th>
                                        <th>Cell No</th>
                                        <th>Address</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

    <div class="modal" tabindex="-1" id="ModalLosts" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Losts</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="LostSearch" class="form-control" aria-controls="LostDetail" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="table-responsive" style="height:300px">
                            <table class="table table-bordered table-striped" id="LostDetail">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Enquiry Id</th>
                                        <th>Enquiry Date</th>
                                        <th>Customer</th>
                                        <th>Lost Date</th>
                                        @*<th>FollowUp Time</th>*@
                                        <th>Lost Reason</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

    <!-- Book Ref No Modal Start -->
    <div class="modal" tabindex="-1" id="BookRefNoModal" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Book Ref No</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="BookRefSearch" class="form-control" aria-controls="BookRefTable" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="table-responsive" style="height:300px;">
                            <table id="BookRefTable" class="table table-striped table-hover responsive">
                                <thead>
                                    <tr>
                                        <th>Sr</th>
                                        <th>Book Ref No</th>
                                        <th>Book Ref Date</th>
                                        <th>Customer</th>
                                        <th>Booking No</th>
                                        <th>Phone</th>
                                    </tr>
                                </thead>
                                <tbody style="font-size:12px; text-transform: uppercase">
                                    @{ int i = 0; }
                                    @if (ViewBag.BookingOrders != null)
                                    {
                                        foreach (var item in ViewBag.BookingOrders)
                                        {
                                            <tr style="text-align:left" onclick="SelectedBookingOrder(this);">
                                                <td> @i</td> @{ i++; }
                                                <td class="tdDiv" nowrap="nowrap" style="width: 13%;" >
                                                    <a href="#" style="color:black"><label id="lblBookrefNo">@item.BookRefNo</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap" style="width: 13%;" >
                                                    <a href="#" style="color:black"><label id="lblBookRefDate">@item.BookRefDate</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap" style="width:27%;" >
                                                    <a href="#" style="color:black"><label id="lblCustomer">@item.CusDesc</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap" style="width:30%;" >
                                                    <a href="#" style="color:black"><label id="lblAddress">@item.BookingNo</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap" style="width:13%;" >
                                                    <a href="#" style="color:black"><label id="lblPhone">@item.PhoneNo</label></a>
                                                </td>

                                            </tr>
                                                        }

                                                    }

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- Book Ref No Modal End -->
    <!-- Delivery Order Modal Start -->
    <div class="modal" tabindex="-1" id="DOModal" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Delivery Orders</h4>
                </div>
                <div class="modal-body">
                    @*<div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="DOSearch" class="form-control" aria-controls="DOTable" placeholder="Search . . . ">
                        </div>
                    </div>*@
                    <div class="form-group row">
                        <div class="table-responsive" style="height:350px">
                            <table id="DOTable" class="table table-striped table-hover responsive">
                                <thead>
                                    <tr>
                                        <th>Sr</th>
                                        <th>DO No</th>
                                        <th>DO Date</th>
                                        <th>Customer</th>
                                        <th>Chassis</th>
                                    </tr>
                                </thead>
                                <tbody style="font-size:12px; text-transform: uppercase">
                                    @{ int j = 0; }
                                    @if (ViewBag.DeliveryOrders != null)
                                    {
                                        foreach (var item in ViewBag.DeliveryOrders)
                                        {
                                            <tr style="text-align:left" onclick="SelectedDeliveryOrder(this);">
                                                <td> @j</td> @{ j++; }
                                                <td class="tdDiv" nowrap="nowrap">
                                                    <a href="#" style="color:black"><label id="lblDONo">@item.DeliveryNo</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap">
                                                    <a href="#" style="color:black"><label id="lblDODate">@item.DeliveryDate</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap">
                                                    <a href="#" style="color:black"><label id="lblCusDesc">@item.CusDesc</label></a>
                                                </td>
                                                <td class="tdDiv" nowrap="nowrap">
                                                    <a href="#" style="color:black"><label id="lblChasisNo">@item.ChasisNo</label></a>
                                                </td>

                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- Delivery Order Modal End -->
</section>

<script src='@Url.Content("~/assets/js/jquery-1.11.2.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/bootstrap.js")'></script>
<script src='@Url.Content("~/Scripts/bootstrap.min.js")'></script>
@*<script src='@Url.Content("~/assets/plugins/datatables/js/jquery.dataTables.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/assets/plugins/datatables/js/jquery.dataTables.min.js")' type="text/javascript"></script>*@

<script src='@Url.Content("/assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/assets/plugins/jquery-ui/smoothness/jquery-ui.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/assets/plugins/daterangepicker/js/moment.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/assets/plugins/daterangepicker/js/daterangepicker.js")' type="text/javascript"></script>

@*<script src='@Url.Content("/assets/js/scripts.js")' type="text/javascript"></script>*@

<script>

    //$(window).load(function () {
    //    $('#cover').fadeOut(1000);

    //});

    //$(function () {
    //    $('.date-picker').datepicker({
    //        changeMonth: true,
    //        changeYear: true,
    //        showButtonPanel: true,
    //        dateFormat: 'MM yy',
    //        onClose: function (dateText, inst) {
    //            $(this).datepicker('setDate', new Date(inst.selectedYear, inst.selectedMonth, 1));
    //        }
    //    });
    //});


    function GetData() {

        var DealerCode = "@Session["DealerCode"].ToString()";
        var fromDate = $("#from").val();
        var toDate = $("#to").val();

        if (fromDate != null && toDate != null) {
            $.ajax({
                dataType: "json",
                async: true,
                type: 'GET',
                url: '@Url.Content("~/Home/GetDataFromDates")',
                data: { 'FromDate': fromDate, 'ToDate': toDate },
                success: function (data) {

                    if (data) {
                        if (data.Success == true) {
                            var item = JSON.parse(data.Response);

                             debugger
                            $("#LeadsCount").text(item[0].GenerateLeads);
                            $("#ConvertedCount").text(item[0].Converted);
                            $("#LostCount").text(item[0].FollowUp);
                            $("#FollowUpCount").text(item[0].Lost);
                            $("#TaskCount").text(item[0].Task);
                            $("#DOCount").text(item[0].DeliveryOrder);
                            $("#BOCount").text(item[0].BookingOrder);
                            $("#StockCount").text(item[0].Stock);
                            $("#InvoiceCount").text(item[0].PendingInvoice);
                            $("#PICount").text(item[0].Invoice);
                            $("#PPCount").text(item[0].PendingPayment);
                            $("#HoldVehicle").text(item[0].TotalHoldVehicle);
                        }
                        else {
                            $("#modalMessage").css("background-color", "#e46457");
                            $("#lblMessage").text(data.Message)
                            $("#section-message").modal('show');
                        }
                    }
                },
                complete: function () {

                },
                error: function (data) {
                    $("#modalMessage").css("background-color", "#e46457");
                    $("#lblMessage").text(data.Message)
                    $("#section-message").modal('show');
                }
            });
        } else {
            $("#modalMessage").css("background-color", "#e46457");
            $("#lblMessage").text("Please Dates first");
            $("#section-message").modal('show');
        }


    }

    $(function () {
        var dateFormat = "dd/mm/yy",
          from = $("#from")
            .datepicker({
                changeMonth: true,
                dateFormat: "dd-mm-yy"
            })
            .on("change", function () {
                to.datepicker("option", "minDate", getDate(this));
            }),
          to = $("#to").datepicker({
              changeMonth: true,
              dateFormat: "dd-mm-yy"
          })
          .on("change", function () {
              from.datepicker("option", "maxDate", getDate(this));
          });

        function getDate(element) {
            var date;
            try {
                date = $.datepicker.parseDate(dateFormat, element.value);
            } catch (error) {
                date = null;
            }

            return date;
        }
    });

    $(document).ready(function () {
        Get_AlertEnquiryDetailsData('leads');
        Get_AlertEnquiryDetailsData('Converted');
        Get_FollowUpDetailsData();
        Get_LostEnquiriesDetailsData();
    })

    function ShowFollowUps(type) {

        $('#ModalFollowUp').modal("show");

    }

    function ShowLosts(type) {

        $('#ModalLosts').modal("show");

    }


    function ShowBookingOrder(type) {

        $('#BookRefNoModal').modal("show");

    }

    function ShowDeliveryOrder(type) {

        $('#DOModal').modal("show");

    }

    function ShowLeads(type) {

        $('#ModalLeads').modal("show");

    }

    function ShowConvertedLeads(type) {

        $('#ModalConverted').modal("show");

    }


    $("#FollowUpSearch").on("keyup", function () {

        var val = $(this).val();
        var value = val.toUpperCase();

        $("#FollowUpDetail tbody tr").each(function () {

            $row = $(this);
            var id = $(this).closest('tr').find('#lblEnquiryId').text();
            var desc = $(this).closest('tr').find('#lblName').text();
            var enqdate = $(this).closest('tr').find('#lblEnqDate').text();
            var followDate = $(this).closest('tr').find('#lblFollowUpDate').text();

            if (id.indexOf(value) !== 0 && desc.toLowerCase().indexOf(value.toLowerCase()) !== 0  && enqdate.indexOf(value) !== 0 && followDate.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }

        });
    });


    $("#EnquirySearch").on("keyup", function () {

        var val = $(this).val();
        var value = val.toUpperCase();

        $("#EnquiryDetail tbody tr").each(function () {

            $row = $(this);
            var id = $(this).closest('tr').find('#lblEnquiryId').text();
            var desc = $(this).closest('tr').find('#lblName').text();
            var enqdate = $(this).closest('tr').find('#lblEnqDate').text();
            var followDate = $(this).closest('tr').find('#lblFollowUpDate').text();

            if (id.indexOf(value) !== 0 && desc.toLowerCase().indexOf(value.toLowerCase()) !== 0 && enqdate.indexOf(value) !== 0 && followDate.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }

        });
    });

    $("#ConvertedSearch").on("keyup", function () {

        var val = $(this).val();
        var value = val.toUpperCase();

        $("#ConvertedLeadsDetail tbody tr").each(function () {
            debugger
            $row = $(this);
            var id = $(this).closest('tr').find('#lblEnquiryId').text();
            var desc = $(this).closest('tr').find('#lblName').text();
            var enqdate = $(this).closest('tr').find('#lblMobile').text();

            if (id.indexOf(value) !== 0 && desc.toLowerCase().indexOf(value.toLowerCase()) !== 0 && enqdate.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }

        });
    });

    $("#LostSearch").on("keyup", function () {

        var val = $(this).val();
        var value = val.toUpperCase();

        $("#LostDetail tbody tr").each(function () {

            $row = $(this);
            var id = $(this).closest('tr').find('#lblEnquiryId').text();
            var desc = $(this).closest('tr').find('#lblName').text();
            var enqdate = $(this).closest('tr').find('#lblEnqDate').text();
            var followDate = $(this).closest('tr').find('#lblFollowUpDate').text();

            if (id.indexOf(value) !== 0 && desc.toLowerCase().indexOf(value.toLowerCase()) !== 0 && enqdate.indexOf(value) !== 0 && followDate.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }

        });
    });


    $("#BookRefSearch").on("keyup", function () {

        var val = $(this).val();
        var value = val.toUpperCase();

        $("#BookRefTable tbody tr").each(function () {

            $row = $(this);
            var id = $(this).closest('tr').find('#lblBookRefNo').text();
            var desc = $(this).closest('tr').find('#lblCustomer').text();
            var enqdate = $(this).closest('tr').find('#lblBookRefDate').text();

            if (id.indexOf(value) !== 0 && desc.toLowerCase().indexOf(value.toLowerCase()) !== 0 && enqdate.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }

        });
    });

    function Get_FollowUpDetailsData() {
        var rowCount = 1;
        var dataCount = 1;
        var SNo = 1;

        $.ajax({
            dataType: "json",
            async: true,
            type: 'GET',
            url: '@Url.Content("~/Home/Select_AlertFollowUpData")',
            success: function (data) {

                if (data.Success == true) {
                    var item = JSON.parse(data.Response)
                    $("#FollowUpDetail tbody tr").remove()
                    //ProductDetail
                    if (item.length > 0) {

                        $.each(item, function (value, item) {
                             ;
                            $("#FollowUpDetail tbody").append('<tr onclick="SelectedFollowUp(this);" id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                                '<td>' + SNo++ + '</td>' +
                                                                '<td> <label id="lblEnquiryId">' + item.Enquiry_ID + ' </label></td>' +
                                                                '<td> <label id="lblEnqDate">' + item.EnqDate + ' </label></td>' +
                                                                '<td> <label id="lblName">' + item.Name + ' </label></td>' +
                                                                '<td> <label id="lblFollowUpDate">' + item.NextFollowUpDate + ' </label></td>' +
                                                                '<td> <label id="lblFollowUpTime">' + item.NextFollowUpTime + ' </label></td>' +
                                                                '<td> <label id="lblFollowupActionPlan">' + item.NextFollowupActionPlan + ' </label></td>' +
                                                                '</tr>');

                        });

                    }
                }
            },
            complete: function () {

            },
        });
    }

    function SelectedFollowUp(value) {

      

         var dealerCode="@Session["DealerCode"].ToString()";
        var leadId = $(value).closest('tr').find("#lblEnquiryId").text();
 $.ajax({
            dataType: "json",
            async: true,
            type: 'Get',
            data: { 'EnquiryId': leadId, 'EnDealerCode': dealerCode, 'EnCLose': "" },
            url: '@Url.Content("~/Enquiry/DTRRedirectLCV")',

            success: function (data) {

                window.location.href = '@Url.Content("~/Enquiry/FollowUp")'; // your action should return an object having [redirecturl] property

            },
        });
    }

    function Get_AlertEnquiryDetailsData(enquiry) {
        var rowCount = 1;
        var dataCount = 1;
        var SNo = 1;

        var Enquiry = enquiry;
        var url = '@Url.Content("~/Home/Select_AlertEnquiryData")';

        $.ajax({
            dataType: "json",
            async: true,
            type: 'GET',
            url: url,
            data: { 'Enquiry': Enquiry },
            success: function (data) {
                if (data.Success == true) {
                    var item = JSON.parse(data.Response)

                    if (enquiry == 'leads') {
                        $("#EnquiryDetail tbody tr").remove();
                    } else {
                        $("#ConvertedLeadsDetail tbody tr").remove();
                    }

                    //ProductDetail
                    if (item.length > 0) {
                        $.each(item, function (value, item) {

                            if (enquiry == 'leads') {
                                $("#EnquiryDetail tbody").append('<tr onclick="SelectedEnquiry(this);" style="cursor: pointer;" id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                    '<td>' + SNo++ + '</td>' +
                                                    '<td> <label id="lblEnquiryId">' + item.Enquiry_ID + ' </label></td>' +
                                                    '<td> <label id="lblEnqDate">' + item.EnqDate + ' </label></td>' +
                                                    '<td> <label id="lblName">' + item.Name + ' </label></td>' +
                                                    '<td> <label id="lblMobile">' + item.Mobile + ' </label></td>' +
                                                    '<td> <label id="lblResAddress">' + item.ResAddress + ' </label></td>' +
                                                    '</tr>');
                            } else {
                                $("#ConvertedLeadsDetail tbody").append('<tr id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                   '<td>' + SNo++ + '</td>' +
                                                   '<td> <label id="lblEnquiryId">' + item.Enquiry_ID + ' </label></td>' +
                                                   '<td> <label id="lblEnqDate">' + item.EnqDate + ' </label></td>' +
                                                   '<td> <label id="lblName">' + item.Name + ' </label></td>' +
                                                   '<td> <label id="lblMobile">' + item.Mobile + ' </label></td>' +
                                                   '<td> <label id="lblResAddress">' + item.ResAddress + ' </label></td>' +
                                                   '</tr>');
                            }



                        });

                    }
                }
            },
            complete: function () {

            },
        });

        //}

    }

    function SelectedEnquiry(value) {

        var leadId = $(value).closest('tr').find("#lblEnquiryId").text();

        @*var baseurl = '@Url.Action("FollowUp", "Enquiry")';
        var url = baseurl + '?EnquiryId=' + leadId + '';*@
        window.location.href = "/Enquiry/EnquiryDetail?leadId=" + leadId;
    }

    function Get_LostEnquiriesDetailsData() {
        var rowCount = 1;
        var dataCount = 1;
        var SNo = 1;

        $.ajax({
            dataType: "json",
            async: true,
            type: 'GET',
            url: '@Url.Content("~/Home/Select_LostEnquiriesData")',
            success: function (data) {

                if (data.Success == true) {
                    var item = JSON.parse(data.Response)
                    $("#LostDetail tbody tr").remove()
                    //ProductDetail
                    if (item.length > 0) {

                        $.each(item, function (value, item) {
                             ;
                            $("#LostDetail tbody").append('<tr onclick="SelectedLost(this);" id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                                '<td>' + SNo++ + '</td>' +
                                                                '<td> <label id="lblEnquiryId">' + item.Enquiry_ID + ' </label></td>' +
                                                                '<td> <label id="lblEnqDate">' + item.EnqDate + ' </label></td>' +
                                                                '<td> <label id="lblName">' + item.Name + ' </label></td>' +
                                                                '<td> <label id="lblLostDate">' + item.LostDate + ' </label></td>' +
                                                                //'<td> <label id="lblFollowUpTime">' + item.NextFollowUpTime + ' </label></td>' +
                                                                '<td> <label id="lblNextFollowUpPurpose">' + item.ReasonDesc + ' </label></td>' +
                                                                '</tr>');

                        });

                    }
                }
            },
            complete: function () {

            },
        });
    }

    function SelectedLost(value) {

        var leadId = $(value).closest('tr').find("#lblEnquiryId").text();

        @*var baseurl = '@Url.Action("FollowUp", "Enquiry")';
        var url = baseurl + '?EnquiryId=' + leadId + '';*@
        window.location.href = "/Enquiry/FollowUp?EnquiryId=" + leadId;
    }

    function SelectedBookingOrder(value) {

        var leadId = $(value).closest('tr').find("#lblBookrefNo").text();

        window.location.href = "/BookingOrder/BOMain?EnquiryId=" + leadId;
    }

    function SelectedDeliveryOrder(value) {

        var leadId = $(value).closest('tr').find("#lblDONo").text();

        window.location.href = "/DeliveryOrder/DOMain?EnquiryId=" + leadId;
    }

</script>

