
@{
    ViewBag.Title = "AdvanceServicesCharges";
    Layout = "~/Views/Shared/_LayoutV2.cshtml";
}
<link href="~/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="~/assets/plugins/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" />
<link href='@Url.Content("~/assets/plugins/jquery-ui/smoothness/jquery-ui.min.css")' rel="stylesheet" type="text/css" media="screen" />
<link href="../assets/plugins/datepicker/css/datepicker.css" rel="stylesheet" type="text/css" media="screen" />

<style>
    .makespace {
        margin-bottom: 0.5rem;
    }

    .icheckbox_minimal-blue {
        top: 10px;
    }
     .mandatory {
        color: red;
        margin-left: 5px;
    }
</style>
<section class="wrapper main-wrapper row">
    <form method="post">
        <div class="col-xs-12">
            <section class="box">
                <header class="panel_header">
                    <h2 class="title pull-left">Advance/Services Charges</h2>
                    <div class="actions panel_actions pull-right">
                        <a class="box_toggle fa fa-chevron-down"></a>
                        @*<a class="box_setting fa fa-cog" data-toggle="modal" href="#section-settings"></a>*@
                    </div>
                </header>
                <div class="content-body">

                    <div class="row" style="margin-bottom:1rem">
                        <div class="form-group row container-fluid">

                            <div class="col-md-2">
                                <label class="form-label">Receipt No</label>
                                <div class="input-group">
                                    <div class="input-group-addon"><a onclick="ShowModal('Receipt')"><i class="fa fa-pencil-square-o"></i></a></div>
                                    <input type="text" class="form-control" id="txtReceiptNo" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-2">
                                <label class="form-label">Receipt Date</label>
                                <div class="input-group">
                                    <div class="input-group-addon"><a><i class="fa fa-calendar"></i></a></div>
                                    <input type="text" class="form-control" id="txtReceiptDate" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-4 hidden">
                                <label class="form-label">Service Type</label>
                                <div class="input-group">
                                    <div class="input-group-addon"><a><i class="fa fa-arrow-down"></i></a></div>
                                    <select class="dropdown-toggle form-control" id="ddlIncType">
                                        <option value="0">Select</option>
                                        <option value="CSI">CSI</option>
                                        <option value="ISI">ISI</option>
                                        <option value="CrdSI">CrdSI</option>
                                        <option value="WOI">WOI</option>
                                    </select>

                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-2">
                                <label class="form-label">Sale Invoice No</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><a id="IssueClick" onclick="ShowModal('SaleInvoice')" style="color:blue"><i class="fa fa-search"></i></a></span>
                                    <input type="text" class="form-control" id="txtSaleInvoiceNo" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>


                            <div class="col-md-2">
                                <label class="form-label">Sale Invoice Date</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control" id="txtSaleInvoiceDate" value="@ViewBag.CurrentDate" data-date-format='dd/MM/yyyy' placeholder="dd/mm/yyyy" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-4 hidden">
                                <label class="form-label">Ref Document No</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control" id="txtRefDocNo" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-4">
                                <label class="form-label">Customer</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-pie-chart"></i></span>
                                    <input type="text" class="form-control" id="txtCustomer" readonly>
                                    <input type="hidden" id="hdnCusCode" />

                                </div>
                                <div class="makespace"></div>
                            </div>

                            @*<div class="col-md-4">
                                    <label class="form-label">SO Date</label>
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                        <input type="text" class="form-control" id="txtSODate" placeholder="dd/mm/yyyy" readonly>
                                    </div>
                                </div>*@

                            <div class="col-md-4 hidden">
                                <label class="form-label">Serve Qty</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    <input type="text" class="form-control" id="txtServeQty" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>


                            <div class="col-md-4">
                                <label class="form-label">Engine No</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user-md"></i></span>
                                    <input type="text" class="form-control" id="txtEngineNo" name="Customer" readonly />
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-4">
                                <label class="form-label">Chassis No</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-adjust"></i></span>
                                    <input type="text" class="form-control" id="txtChassisNo" name="FaxNo" readonly />
                                </div>
                                <div class="makespace"></div>
                            </div>

                            <div class="col-md-4">
                                <label class="form-label">Vehicle</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-cab"></i></span>
                                    <input type="text" class="form-control" id="txtVehicle" name="Engine" readonly />
                                </div>
                                <div class="makespace"></div>
                            </div>


                            <div class="col-md-2">
                                <label class="form-label">Sale Price</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-users"></i></span>
                                    <input type="text" class="form-control" id="txtSalePrice" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Market Rate</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-users"></i></span>
                                    <input type="text" class="form-control" id="txtMarketRate" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Discount</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-users"></i></span>
                                    <input type="text" class="form-control" id="txtDiscount" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Total Amount</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-users"></i></span>
                                    <input type="text" class="form-control" id="txtTotal" readonly>
                                </div>
                                <div class="makespace"></div>
                            </div>


                            <div class="col-md-4 hidden">
                                <label class="form-label">Sales Person</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-chevron-right"></i></span>
                                    <input type="text" class="form-control" id="txtSalesPerson" readonly />
                                    <input type="hidden" id="hdnEmpCode" />
                                </div>
                                <div class="makespace"></div>
                            </div>

                            @*<div class="col-md-4 hidden">
                                    <label class="form-label">Total Amount</label>
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
                                        <input type="text" class="form-control" id="txtTotal" name="FaxNo" />
                                    </div>
                                    <div class="makespace"></div>
                                </div>*@




                            @*<div class="col-md-4 pull-left">
                                    <label class="form-label">Registration No</label>
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="glyphicon glyphicon-compressed"></i></span>
                                        <input type="text" class="form-control" id="txtRegistrationNo" name="FaxNo" />
                                    </div>
                                </div>*@

                            <div class="col-md-4">
                                <label class="form-label">Remarks</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
                                    <input type="text" class="form-control" id="txtRemarks" name="FaxNo" />
                                </div>
                                <div class="makespace"></div>
                            </div>


                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">

                            <ul class="nav nav-tabs primary" style="border-radius:0px; border-bottom: 0px;">
                                <li class="active">
                                    <a href="#tabInsService" data-toggle="tab" style="border-radius:0px;">
                                        <i class="fa fa-car"></i>Instrument And Service Detail
                                    </a>
                                </li>

                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane fade in active" id="tabInsService">

                                    <div class="row">

                                        <div class="row" style="margin-left:0px;">
                                            <div class="col-md-4">
                                                <label class="form-label">Service</label>
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
                                                    @Html.DropDownList("ddlVehExpHead", new SelectList((IEnumerable<SelectListItem>)ViewBag.VehExpHead, "Value", "Text", "0"), new { @class = "form-control m-bot15", @id = "ddlVehExpHead", @onchange = "ChangeColor(this)" })
                                                </div>
                                                <div class="makespace"></div>
                                            </div>

                                            <div class="col-md-4">
                                                <label class="form-label">Amount</label>
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="glyphicon glyphicon-credit-card"></i></span>
                                                    <input type="text" class="form-control" id="txtAmount" name="FaxNo" onkeypress="return isNumberKey(event)" onblur="ChangeColor(this)" />
                                                </div>
                                                <div class="makespace"></div>
                                            </div>
                                            <div class="col-md-4 hidden">
                                                <label class="form-label">Account Code*</label>
                                                <div class="input-group">
                                                    <div class="input-group-addon"><a data-toggle="modal" data-target="#POModalActCode" style="color:blue"><i class="fa fa-search" onclick=""></i></a></div>
                                                    @*<span class="input-group-addon"><a id="IssueClick" onclick="ShowModal('Account')" style="color:blue"><i class="fa fa-search"></i></a></span>*@
                                                    <input type="text" class="form-control" id="txtAccountCode" name="FaxNo" style="width:95%;" onblur="ChangeColor(this)" />
                                                </div>
                                                <div class="makespace"></div>
                                            </div>

                                        </div>

                                        <div class="col-md-2">
                                            <label class="form-label">Payment Type</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-search"></i></span>
                                                @Html.DropDownList("ddlPayMode", new SelectList((IEnumerable<SelectListItem>)ViewBag.PayMode, "Value", "Text", "C"), new { @class = "form-control", @id = "ddlPayMode", @onchange = "ChangeColor(this)" })

                                            </div>
                                            <div class="makespace"></div>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Instrument No</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-search"></i></span>
                                                <input type="text" class="form-control" id="txtInstrumentNo" name="FaxNo" onblur="ChangeColor(this)" />

                                            </div>
                                            <div class="makespace"></div>
                                        </div>

                                        <div class="col-md-2">
                                            <label class="form-label">Instrment Date</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                @*<input type="text" class="form-control datepicker" id="txtInsDate" name="FaxNo" placeholder="dd/mm/yyyy" />*@
                                                <input type="text" class="form-control datepicker" id="txtInsDate" data-format="D, dd MM yyyy">

                                            </div>
                                            <div class="makespace"></div>
                                        </div>

                                        <div class="col-md-2">
                                            <label class="form-label">Bank</label>
                                            <div class="input-group">
                                                <div class="input-group-addon"><i class="fa fa-bank"></i></div>
                                                @Html.DropDownList("ddlBank", new SelectList((IEnumerable<SelectListItem>)ViewBag.Bank, "Value", "Text", "0"), new { @class = "form-control m-bot15", @id = "ddlBank", @onchange = "ChangeColor(this)" })
                                            </div>
                                            <div class="makespace"></div>
                                        </div>

                                        <div class="col-md-2">
                                            <label class="form-label">Branch</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="glyphicon glyphicon-credit-card"></i></span>
                                                <input type="text" class="form-control" id="txtBranch" name="FaxNo" onblur="ChangeColor(this)" />
                                            </div>
                                            <div class="makespace"></div>
                                        </div>

                                        <div class="col-md-2">
                                            <label class="form-label">City</label>
                                            <div class="input-group">
                                                <div class="input-group-addon"><i class="glyphicon glyphicon-credit-card"></i></div>
                                                @Html.DropDownList("ddlCity", new SelectList((IEnumerable<SelectListItem>)ViewBag.City, "Value", "Text", "0"), new { @class = "form-control m-bot15", @id = "ddlCity", @onchange = "ChangeColor(this)" })

                                            </div>
                                            <div class="makespace"></div>
                                        </div>



                                        <div class="col-md-8">
                                            <label class="form-label">Naration<span class="mandatory">*</span></label>
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="glyphicon glyphicon-credit-card"></i></span>
                                                <input type="text" class="form-control" id="txtNaration" name="FaxNo" />
                                            </div>
                                            <div class="makespace"></div>
                                        </div>
                                        <div class="col-md-4 pull-right">
                                            <button type="button" class="btn btn-info" id="addItem" style="margin-top:23px; border-radius:0px; width:100%" onclick="AddProduct(this)">+</button>
                                            @*<div class="makespace"></div>*@
                                        </div>
                                        @*<div class="col-md-4 pull-right">
                                                <div class="input-group" style="width:100%;float: right;">
                                                    <button class="btn btn-success btn-sm" type="button" style="width: 100%;padding: 8px; margin-top: 20px; right: 15px;" onclick="AddProduct(this)">
                                                        <i class="fa fa-plus fa-2x"></i>
                                                    </button>
                                                </div>
                                                <div class="makespace"></div>
                                            </div>*@

                                        <div class="row container-fluid" style="margin-top:1rem;">
                                            <div class="col-md-12" style="margin-top:1rem;">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered table-striped" id="tblInstrument" style="white-space: nowrap; FONT-SIZE: 13px;">
                                                        <thead>
                                                            <tr>
                                                                <th>SO No</th>
                                                                <th>Instrument Type</th>
                                                                <th>Instrument No</th>
                                                                <th>Instrument Date</th>
                                                                <th>Bank </th>
                                                                <th>Branch</th>
                                                                <th>City</th>
                                                                <th>Service</th>
                                                                @*<th>Account</th>*@
                                                                <th>Amount</th>
                                                                <th>Naration</th>
                                                                <th>Action</th>

                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-4 pull-right">
                                                <label class="form-label">Total Amount</label>
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class="glyphicon glyphicon-credit-card"></i></span>
                                                    <input type="text" class="form-control" id="txtTAmount" name="FaxNo" onkeypress="return isNumberKey(event)" onblur="ChangeColor(this)" />
                                                </div>
                                                <div class="makespace"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12">
                            <div class="pull-right">

                                @if (DXBMS.SecurityBll.UserRights("2507", "002"))
                                {
                                    <button type="button" class="btn btn-info" id="btnSave" style="margin-top:27px; width:100px; border-radius:0px;">Save</button>
                                }
                                else
                                {
                                    <button type="button" class="btn btn-info" id="btnSave" style="margin-top:27px; width:100px; border-radius:0px; display:none;">Save</button>
                                }
                                @if (DXBMS.SecurityBll.UserRights("2507", "004"))
                                {
                                    <button type="button" class="btn btn-danger" id="btnDelete" style="margin-top:27px; width:100px; border-radius:0px;">Delete</button>
                                }
                                else
                                {
                                    <button type="button" class="btn btn-danger" id="btnDelete" style="margin-top:27px; width:100px; border-radius:0px; display:none;">Delete</button>
                                }
                                @if (DXBMS.SecurityBll.UserRights("2507", "006"))
                                {
                                    <button type="button" class="btn btn-success" id="btnPrint" style="margin-top:27px; width:100px; border-radius:0px;">Print</button>
                                }
                                else
                                {
                                    <button type="button" class="btn btn-success" id="btnPrint" style="margin-top:27px; width:100px; border-radius:0px;display:none;">Print</button>
                                }
                                @if (DXBMS.SecurityBll.UserRights("2507", "005"))
                                {
                                    <button type="button" class="btn btn-warning" id="btnVoucher" style="margin-top: 27px; width: 100px; border-radius:0px;">Voucher</button>
                                }
                                else
                                {
                                    <button type="button" class="btn btn-warning" id="btnVoucher" style="margin-top: 27px; width: 100px; border-radius:0px;display:none;">Voucher</button>
                                }
                               
                                <button type="button" class="btn btn-success" id="btnFForm" style="margin-top:27px; width:100px; border-radius:0px;">F-Form</button>
                                <button type="reset" class="btn btn-default" id="btnClear" style="margin-top:27px; width:100px; border-radius:0px;">Clear</button>

                                

                                

                            </div>
                        </div>
                    </div>

                </div>

            </section>
        </div>
        <style>
            .border-for {
                border: 1px solid blue;
            }

            .label-heading {
                margin: 0.5rem;
            }

            .divider {
                width: 5px;
                height: auto;
                display: inline-block;
            }
        </style>

    </form>

    @*ISI No LookUp*@
    <div class="modal fade bs-example-modal-lg" tabindex="-1" id="SaleInvoiceModal" role="dialog" aria-labelledby="modal123Label" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="margin-top:60px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="modal123Label">Sale Invoices</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group row">
                        <label for="exampleInputuname" class="col-md-2">Search :</label>
                        <div class="col-md-10">
                            <input type="text" id="AccountSearchSO" class="form-control" aria-controls="tblSaleInvoice" placeholder="Search . . . ">
                        </div>
                    </div>
                    <div class="form-group row" style="margin-left:10px">
                        <div class="table-responsive table-Scroll" style="height:300px;">
                            <table id="tblSaleInvoice" class="table color-table info-table">
                                <thead>
                                    <tr>
                                        <th>Sr.</th>
                                        <th class="tdDiv" style="text-align:left" width:"30%">Trans No</th>
                                        <th class="tdDiv" style="text-align:left" width:"30%">Trans Date</th>
                                        <th class="tdDiv" style="text-align:left" width:"30%">Customer Name</th>
                                        <th class="tdDiv" style="text-align:left" width:"30%">Customer Contact</th>
                                        <th class="tdDiv" style="text-align:left" width:"30%">Chassis No</th>
                                    </tr>
                                </thead>
                                <tbody style="font-size:12px; text-transform: uppercase"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>


    @*Save Lookup*@
    <div class="modal" id="section-confirm" tabindex="-1" role="dialog" aria-hidden="true" style="z-index : 10000!important;">
        <div class="modal-dialog animated bounceInDown" style="margin-top:60px">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Confirm</h4>
                </div>
                <div class="modal-body">

                    <h5>Are you sure to want save ?</h5>

                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-danger" type="button">No</button>
                    <button class="btn btn-primary" onclick="SaveMasterEnquiry()">Yes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup box modal start -->
    <div class="modal" id="section-message" tabindex="-1" role="dialog" aria-hidden="true" style="z-index : 10000!important;">
        <div class="modal-dialog animated bounceInDown">
            <div class="modal-content">
                <div class="modal-header" id="modalMessage">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Attention</h4>
                </div>
                <div class="modal-body">

                    <h5 id="lblMessage"></h5>

                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-default" type="button">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- modal end -->
    <div class="modal" id="section-Grid" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog animated bounceInDown" style="margin-top:60px">
            <div class="modal-content">
                <div class="modal-header" style="background-color:red">
                    <h4 class="modal-title">Warning</h4>
                </div>
                <div class="modal-body">

                    <h5>Please Add the Grid Data</h5>

                </div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-danger" onclick="scrollWin(0, 50)" id="btnGrid" type="button">Close</button>
                </div>
            </div>
        </div>
    </div>
</section>


@*InstallmentReceipt No LookUp*@
<div class="modal fade bs-example-modal-lg" tabindex="-1" id="ReceiptModal" role="dialog" aria-labelledby="modal123Label" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin-top:60px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="modal123Label">Receipt Detail</h4>
            </div>
           <div class="modal-body">
                            <div class="form-group row">
                                <label for="exampleInputuname" class="col-md-2">Search :</label>
                                <div class="col-md-10">
                                    <input type="text" id="ReceiptSearchSO" class="form-control" aria-controls="tblReceiptModal" placeholder="Search . . . ">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="table-responsive" style="height:300px;">
                                    <table id="tblReceiptModal" class="table color-table info-table">
                                        <thead>
                                            <tr>
                                                <th>Sr</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Receipt No</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Receipt Date</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Customer</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Vehicle</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">ChassisNo</th>
                                                @*<th class="tdDiv" style="text-align:left" width:"30%">Service Type</th>*@
                                            </tr>
                                        </thead>
                                        <tbody style="font-size:12px; text-transform: uppercase">

                                            @{ int i = 1; }
                                            @if (ViewBag.Receipts != null)
                                            {

                                                foreach (var item in ViewBag.Receipts)
                                                {
                                                    <tr style="text-align: left" onclick="RevClickDetail('@item.ReceiptNo','@item.ReceiptDate','@item.InvoiceNo','@item.InvoiceDate','@item.PRBNo','@item.EmpCode','@item.EmpDesc','@item.EngineNo','@item.ChasisNo','@item.CusCode','@item.ProdDesc','@item.Remarks','@item.CusDesc','@item.TransType','@item.SalePrice','@item.TotalAmount','@item.Discount','@item.MarketRate')">
                                                        <td> @i</td> @{ i++; }
                                                        <td class="tdDiv">
                                                            <a href="#" style="color:black">@item.ReceiptNo</a>
                                                        </td>
                                                        <td class="tdDiv">
                                                            <a href="#" style="color:black">@item.ReceiptDate</a>
                                                        </td>
                                                        <td class="tdDiv">
                                                            <a href="#" style="color:black">@item.CusDesc</a>
                                                        </td>
                                                        <td class="tdDiv">
                                                            <a href="#" style="color:black">@item.ProdDesc</a>
                                                        </td>
                                                        <td class="tdDiv">
                                                            <a href="#" style="color:black">@item.ChasisNo</a>
                                                        </td>
                                                    </tr>
                                                                }
                                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            @*<button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>*@
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>

            <div class="modal" id="section-confirm-Delete" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog animated bounceInDown">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title">Confirm</h4>
                        </div>
                        <div class="modal-body">

                            <h5>Are you sure want to Delete ?</h5>

                        </div>
                        <div class="modal-footer">
                            <button data-dismiss="modal" class="btn btn-default" type="button">Close</button>
                            <button class="btn btn-danger" type="button" onclick="DeleteEnquiry()">Delete</button>
                        </div>
                    </div>
                </div>
            </div>

            @*Bank LookUp*@
            <div class="modal" tabindex="-1" id="POModalActCode" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content" style="margin-top:60px;">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                            <h4 class="modal-title" id="modal123Label">Account Detail</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group row">
                                <label for="exampleInputuname" class="col-md-2">Search :</label>
                                <div class="col-md-10">
                                    <input type="text" id="AccountSearchSO" class="form-control" aria-controls="AccountTable" placeholder="Search . . . ">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="table-responsive" style="height:300px;">
                                    <table id="AccountTable" class="table table-striped table-hover responsive">
                                        <thead>
                                            <tr>
                                                <th>Account Code</th>
                                                <th>Account Title </th>

                                            </tr>
                                        </thead>
                                        <tbody style="font-size:12px; text-transform: uppercase">

                                            @{ int j = 1; }
                                            @if (ViewBag.Accounts != null)
                                {

                                    foreach (var item in ViewBag.Accounts)
                                    {
                                <tr style="text-align: left" onclick="ClickAccount('@item.AccountCode','@item.AccountDesc')">

                                    <td class="tdDiv">
                                        <a href="#" style="color:black">@item.AccountCode</a>
                                    </td>
                                    <td class="tdDiv">
                                        <a href="#" style="color:black">@item.AccountDesc</a>
                                    </td>

                                </tr>
                                    }
                                }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" style="text-transform: uppercase;" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>

            @*Bank LookUp*@
            <div class="modal fade bs-example-modal-lg" tabindex="-1" id="POModalCity" role="dialog" aria-labelledby="modal123Label" aria-hidden="true" style="display: none;">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content" style="margin-top:150px; height:500px;width:800px">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                            <h4 class="modal-title" id="modal123Label">City Detail</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group row">
                                <label for="exampleInputuname" class="col-md-2">Search :</label>
                                <div class="col-md-10">
                                    <input type="text" id="AccountSearchSO" class="form-control" aria-controls="AccountTableSO" placeholder="Search . . . ">
                                </div>
                            </div>
                            <div class="form-group row" style="margin-left:10px">
                                <div class="table-responsive table-Scroll" style=" height:280px;width:750px">
                                    <table id="AccountTableSO" class="table color-table info-table">
                                        <thead class="bg-primary">
                                            <tr>
                                                <th class="tdDiv" style="text-align:left" width:"30%">City Code</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">City Name</th>
                                            </tr>
                                        </thead>
                                        <tbody style="font-size:12px; text-transform: uppercase">
                                            @*@if (ViewBag.ISIIRDetail != null)
                                                {
                                                    foreach (var item in ViewBag.ISIIRDetail)
                                                    {
                                                        <tr style="text-align: left" onclick="RevClickISIDetail('@item.TransCode','@item.TransDate','@item.EmpCode','@item.EmpName','@item.CusCode','@item.CusDesc','@item.EngineNo','@item.ChasisNo','@item.MonthlyInstallment','@item.NoOfInstallment','@item.VersionCode','@item.CellNo')">
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.TransCode</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.TransDate</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.CusDesc</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.CellNo</a>
                                                            </td>
                                                        </tr>
                                                    }
                                                }*@
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            @*<button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>*@
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>
            @*Bank LookUp*@
            <div class="modal fade bs-example-modal-lg" tabindex="-1" id="POModalBank" role="dialog" aria-labelledby="modal123Label" aria-hidden="true" style="display: none;">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content" style="margin-top:150px; height:500px;width:800px">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                            <h4 class="modal-title" id="modal123Label">Bank Detail</h4>
                        </div>
                        <div class="modal-body">
                            <div class="form-group row">
                                <label for="exampleInputuname" class="col-md-2">Search :</label>
                                <div class="col-md-10">
                                    <input type="text" id="AccountSearchSO" class="form-control" aria-controls="AccountTableSO" placeholder="Search . . . ">
                                </div>
                            </div>
                            <div class="form-group row" style="margin-left:10px">
                                <div class="table-responsive table-Scroll" style=" height:280px;width:750px">
                                    <table id="AccountTableSO" class="table color-table info-table">
                                        <thead class="bg-primary">
                                            <tr>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Bank Code</th>
                                                <th class="tdDiv" style="text-align:left" width:"30%">Bank Name</th>
                                            </tr>
                                        </thead>
                                        <tbody style="font-size:12px; text-transform: uppercase">
                                            @*@if (ViewBag.ISIIRDetail != null)
                                                {
                                                    foreach (var item in ViewBag.ISIIRDetail)
                                                    {
                                                        <tr style="text-align: left" onclick="RevClickISIDetail('@item.TransCode','@item.TransDate','@item.EmpCode','@item.EmpName','@item.CusCode','@item.CusDesc','@item.EngineNo','@item.ChasisNo','@item.MonthlyInstallment','@item.NoOfInstallment','@item.VersionCode','@item.CellNo')">
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.TransCode</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.TransDate</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.CusDesc</a>
                                                            </td>
                                                            <td class="tdDiv">
                                                                <a href="#" style="color:black">@item.CellNo</a>
                                                            </td>
                                                        </tr>
                                                    }
                                                }*@
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            @*<button type="button" class="btn btn-danger waves-effect text-left" data-dismiss="modal">Close</button>*@
                        </div>
                    </div>
                    <!-- /.modal-content -->
                </div>
                <!-- /.modal-dialog -->
            </div>

            @*<script src='@Url.Content("~/assets/js/jquery-1.11.2.min.js")' type="text/javascript"></script>
                <script src='@Url.Content("~/Scripts/bootstrap.js")'></script>
                <script src='@Url.Content("~/Scripts/bootstrap.min.js")'></script>*@


            <link href='@Url.Content("~/assets/plugins/select2/select2.css")' rel="stylesheet" type="text/css" media="screen" />
            <link href='@Url.Content("~/assets/plugins/icheck/skins/minimal/blue.css")' rel="stylesheet" type="text/css" media="screen" />
            <script src='@Url.Content("~/assets/js/jquery-1.11.2.min.js")' type="text/javascript"></script>
            @*<script src='@Url.Content("~/Scripts/bootstrap.min.js")'></script>*@

            <script>
                $(document).ready(function () {
                    $("#AccountSearchSO").on("keyup", function () {
                        var value = $(this).val().toLowerCase();
                        $("#tblSaleInvoice tr").filter(function () {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        });
                    });
                });
                $(document).ready(function () {
                    $("#AccountSearchSO").on("keyup", function () {
                        var value = $(this).val().toLowerCase();
                        $("#AccountTable tr").filter(function () {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        });
                    });
                });
                $(document).ready(function () {
                    $("#ReceiptSearchSO").on("keyup", function () {
                        var value = $(this).val().toLowerCase();
                        $("#tblReceiptModal tr").filter(function () {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        });
                    });
                });
                $(document).ready(function () {
                    getSaleInvoice();
                    var paymode = $("#ddlPayMode").val();

                    debugger;


                    if (paymode == "C" && $("#ddlPayMode").val() == "C") {
                        $("#txtInstrumentNo").prop('disabled', true);
                        $("#txtInsDate").prop('disabled', true);
                        $("#ddlBank").prop('disabled', true);
                        $("#txtInsDate").prop('disabled', true);
                        $("#txtBranch").prop('disabled', true);
                        $("#ddlCity").prop('disabled', true);
                        // $("#txtInsDate").prop('disabled', false);
                    }
                    var today = new Date();
                    var dd = today.getDate();
                    var mm = today.getMonth() + 1; //January is 0!
                    var yyyy = today.getFullYear();

                    $(".datepicker").datepicker({
                        dateFormat: "dd-mm-yy"
                    });

                    if (dd < 10) {
                        dd = '0' + dd
                    }

                    if (mm < 10) {
                        mm = '0' + mm
                    }

                    today = dd + '-' + mm + '-' + yyyy;

                    $("#txtReceiptDate").val(today);
                    //$("#txtInsDate").val(today);



                })

                $("#ddlPayMode").change(function () {
                    var paymode = $("#ddlPayMode").val();

                    debugger;


                    if (paymode != "C" && $("#ddlPayMode").val() != "C") {
                        $("#txtInstrumentNo").prop('disabled', false);
                        $("#txtInsDate").prop('disabled', false);
                        $("#ddlBank").prop('disabled', false);
                        $("#txtInsDate").prop('disabled', false);
                        $("#txtBranch").prop('disabled', false);
                        $("#ddlCity").prop('disabled', false);
                        // $("#txtInsDate").prop('disabled', false);
                    }
                    else {

                        $("#txtInstrumentNo").prop('disabled', true);
                        $("#txtInsDate").prop('disabled', true);
                        $("#ddlBank").prop('disabled', true);
                        $("#txtInsDate").prop('disabled', true);
                        $("#txtBranch").prop('disabled', true);
                        $("#ddlCity").prop('disabled', true);


                    }
                })

                $("#ddlVehExpHead").change(function () {
                    debugger
                    var type = $("#ddlVehExpHead :selected").text();
                    var service = type.split("| ")[0];
                    var account = type.split("| ")[1];
                    var defaultvalue = type.split("| ")[2];
                    $('#txtAmount').val(defaultvalue);

                });

                function ChangeColor(value) {

                    if ($(value).val() != '')
                        $(value).css("border-color", "#e1e1e1");
                }

                function ShowModal(type) {

                    if (type == 'Receipt') {
                        $('#ReceiptModal').modal("show");
                    } else
                        if (type == 'Account') {
                            $('#POModalActCode').modal("show");
                        } else if (type == 'SaleInvoice') {
                            $('#SaleInvoiceModal').modal("show");
                        } else {
                            $('#EnquiryNoModal').modal("show");
                        }
                }

                function isNumberKey(evt) {
                    var charCode = (evt.which) ? evt.which : event.keyCode
                    if (charCode > 31 && (charCode < 48 || charCode > 57))
                        return false;
                    return true;
                }

                //$("#ddlIncType").change(function () {
                //    var type = $("#ddlIncType").val();
                //    if (type != "0") {
                //        getSaleInvoice(type);

                //    }
                //});


                function getSaleInvoice(id) {

                    var rowCount = 1;
                    var dataCount = 1;
                    var SNo = 1;

                    var leadId = id;
                    var dealerCode = "@Session["DealerCode"].ToString()";

                    if (leadId != "0") {
                        $.ajax({
                            dataType: "json",
                            async: true,
                            type: 'GET',
                            url: '@Url.Content("~/SaleOrder/Get_SaleInvoiceModal")',
                            data: { 'EnquiryId': leadId, 'DealerCode': dealerCode },
                            success: function (data) {
                                if (data.Success == true) {
                                    var item = JSON.parse(data.Response)
                                    $("#tblSaleInvoice tbody tr").remove()
                                    if (item.length > 0) {

                                        $.each(item, function (value, item) {

                                            var temp = '<tr id="DelChkListRow1' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '" onclick="IssueFunc(this)">' +
                                                '<td>' + SNo++ + '</td>' +
                                          '<td class="tdDiv" style="overflow:auto"><label id="lblTransNo">' + item.TransCode + '</label></td>' +
                                          '<td class="tdDiv" style="overflow:auto"><label id="lblTransDate">' + item.TransDate + '</label></td>' +
                                          '<td class="tdDiv" style="overflow:auto"><label id="lblCusDesc">' + item.CusDesc + '</label></td>' +
                                          '<td class="tdDiv" style="overflow:auto"><label id="lblContactNo">' + item.ContactNo + '</label></td>' +
                                          '<td class="tdDiv" style="overflow:auto"><label id="lblChasisNo">' + item.ChassisNo + '</label></td>' +
                                            '</tr>';

                                            $("#tblSaleInvoice tbody").append(temp);

                                        });

                                    }
                                }
                            },
                            complete: function () {

                            },
                        });
                    }
                }

                ClickAccount = function (AccountDesc) {
                    debugger
                    $('#txtAccountCode').val(AccountDesc);
                    $('#txtAccountCode').css("border-color", "#e1e1e1");

                    $("#POModalActCode").modal("hide");
                }

                IssueFunc = function (value) {
                    debugger

                    var transNo = $(value).closest('tr').find("#lblTransNo").text();
                    var chasisNo = $(value).closest('tr').find("#lblChasisNo").text();

                    getSaleInvoiceDetail(transNo, chasisNo);

                    $("#SaleInvoiceModal").modal("hide");
                }

                function getSaleInvoiceDetail(transNo, chasisNo) {

                    var DealerCode = "@Session["DealerCode"].ToString()";

                    if (transNo != "0" && transNo != "") {
                        $.ajax({
                            dataType: "json",
                            async: true,
                            type: 'GET',
                            url: '@Url.Content("~/SaleOrder/Get_SaleInvoiceDetail")',
                            data: { 'TransNo': transNo, 'ChasisNo': chasisNo, 'DealerCode': DealerCode },
                            success: function (data) {

                                if (data.Success == true) {
                                    var item = JSON.parse(data.Response)

                                    //Event Information
                                    debugger
                                    $("#txtSaleInvoiceNo").val(item[0].TransCode);
                                    $("#txtSaleInvoiceDate").val(item[0].TransDate);
                                    $("#txtRefDocNo").val(item[0].RefDocumentNo);
                                    $("#txtServeQty").val(item[0].ServceQty);
                                    $("#txtSalePrice").val(item[0].FactoryPrice);
                                    $("#txtCustomer").val(item[0].CusDesc);
                                    $("#hdnCusCode").val(item[0].CusCode);
                                    $("#txtSalesPerson").val(item[0].EmpName);
                                    $("#hdnEmpCode").val(item[0].EmpCode);
                                    $("#txtCellNo").val(item[0].ContactNo);
                                    $("#txtVehicle").val(item[0].ProdDesc);
                                    $("#txtChassisNo").val(item[0].ChassisNo);
                                    $("#txtEngineNo").val(item[0].EngineNo);
                                    $("#txtMarketRate").val(item[0].MarketRate);
                                    $("#txtDiscount").val(item[0].Discount);
                                    $("#txtTotal").val(item[0].TotalAmount);
                                }
                            },
                            complete: function () {

                            },
                        });

                    }
                }

                var rowCount = 1;
                var dataCount = 1;
                var SNo = 1;

                function AddProduct(value) {
                    debugger
                    var check = ValidateDetail();

                    if (check == true) {
                        debugger
                        var PayModeCode = $("#ddlPayMode").val();
                        var PayModeDesc = $("#ddlPayMode :selected").text();
                        var InsNo = $("#txtInstrumentNo").val();
                        var insDate = $("#txtInsDate").val();
                        var bankCode = $("#ddlBank").val();
                        var bankDesc = $("#ddlBank :selected").text();
                        var branch = $("#txtBranch").val();
                        var cityCode = $("#ddlCity").val();
                        var cityDesc = $("#ddlCity :selected").text();
                        var serviceCode = $("#ddlVehExpHead").val();
                        var serviceDesc = $("#ddlVehExpHead :selected").text();
                        var account = $("#txtAccountCode").val();
                        var amount = $("#txtAmount").val();
                        var naration = $("#txtNaration").val();
                        if ($("#ddlBank").val() == 0)
                        {
                            bankDesc = "";


                        }

                    if($("#ddlCity").val()==0)   
                        {
                        cityDesc="";



                        }

                        var row = $(value).parent().parent().html();
                        var dt = $("#tblInstrument tbody").append('<tr id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                                    '<td>' + SNo++ + '</td>' +
                                                                    '<td> <label id="lblPayMode">' + PayModeDesc + ' </label><input type="hidden" id="hdnPayModeCode" value="' + PayModeCode + '"/></td>' +
                                                                    '<td> <label id="lblInsNo">' + InsNo + ' </label></td>' +
                                                                    '<td> <label id="lblInsDate">' + insDate + ' </label></td>' +

                                                                    '<td> <label id="lblBank">' + bankDesc + ' </label><input type="hidden" id="hdnBankCode" value="' + bankCode + '"/></td>' +
                                                                    '<td> <label id="lblBranch">' + branch + ' </label></td>' +
                                                                    '<td> <label id="lblCity">' + cityDesc + ' </label><input type="hidden" id="hdnCityCode" value="' + cityCode + '"/></td>' +

                                                                    '<td> <label id="lblService">' + serviceDesc + ' </label><input type="hidden" id="hdnServiceCode" value="' + serviceCode + '"/></td>' +
                                                                    //'<td> <label id="lblAccount">' + account + ' </label></td>' +
                                                                    '<td> <label id="lblAmount">' + amount + ' </label></td>' +

                                                                    '<td> <label id="lblNaration">' + naration + ' </label></td>' +
                                                                    '<td style="text-align:center;">' +
                                                                        '<a class="selectItem"><i class="fa fa-edit" style="color:blue"></i></a>&nbsp;&nbsp;|&nbsp;&nbsp;<a class= "deleteItem" style="color:blue" ><i class="fa fa-trash"></i></a></td>' +
                                                                    '</tr>');

                        clearVehilceFeilds();

                        var TotalQty = $("#txtTotal").val();
                        TotalQty = +parseInt(TotalQty) + parseInt(amount);
                        $('#txtTAmount').val(TotalQty);
                    }
                    else {
                        $("#lblMessage").html("Please fill the Required feilds");
                           $("#section-message").modal("show");
                    }
                }

                $("table#tblInstrument").on('click', '.selectItem', function () {
                    rIndex = $(this).closest('tr');
                    index = $(this).closest('tr')[0].rowIndex;
                    debugger

                    var PayModeCode = $(rIndex).closest('tr').find("#hdnPayModeCode").val();

                    var InsNo = $(rIndex).closest('tr').find("#lblInsNo").text();
                    var InsDate = $(rIndex).closest('tr').find("#lblInsDate").text();
                    var BankCode = $(rIndex).closest('tr').find("#hdnBankCode").val();
                    var Branch = $(rIndex).closest('tr').find("#lblBranch").text();
                    var CityCode = $(rIndex).closest('tr').find("#hdnCityCode").val();
                    var ServiceCode = $(rIndex).closest('tr').find("#hdnServiceCode").val();
                    var Account = $(rIndex).closest('tr').find("#lblAccount").text();
                    var Amount = $(rIndex).closest('tr').find("#lblAmount").text();
                    var Naration = $(rIndex).closest('tr').find("#lblNaration").text();

                    var TotalQty = $("#txtTotal").val();

                    TotalQty = TotalQty - Amount;

                    $('#ddlPayMode').val(PayModeCode);
                    $('#txtInstrumentNo').val(InsNo);
                    $('#txtInsDate').val(InsDate);
                    $('#ddlBank').val(BankCode);
                    $('#txtBranch').val(Branch);
                    $('#ddlCity').val(CityCode);
                    $('#ddlVehExpHead').val(ServiceCode);
                    $('#txtAccountCode').val(Account);
                    $('#txtAmount').val(Amount);
                    $('#txtNaration').val(Naration);


                    $('#txtTotal').value = TotalQty;

                    if (PayModeCode == "C") {
                        document.getElementById("ddlPayMode").options[0].disabled = true;
                        document.getElementById("ddlPayMode").options[2].disabled = true;
                        document.getElementById("ddlPayMode").options[3].disabled = true;
                        document.getElementById("ddlPayMode").options[4].disabled = true;
                        document.getElementById("ddlPayMode").options[5].disabled = true;
                        document.getElementById("ddlPayMode").options[6].disabled = true;
                        document.getElementById("ddlPayMode").options[7].disabled = true;
                        document.getElementById("ddlPayMode").options[8].disabled = true;
                        document.getElementById("ddlPayMode").options[9].disabled = true;
            


                    }


                    $(this).closest('tr').remove();

                });

                function clearVehilceFeilds() {

                    $("#ddlPayMode").val("C");
                    $("#txtInstrumentNo").val("");
                    $("#txtInsDate").val("");
                    $("#ddlBank").val("0");
                    $("#txtBranch").val("");
                    $("#ddlCity").val("0");
                    $("#ddlVehExpHead").val("0");
                    $("#txtAccountCode").val("");
                    $("#txtNaration").val("");
                    $("#txtAmount").val("");
                  
                }

                function ValidateDetail() {
                    debugger
                    var count = 0;

                    var PayModeCode = $("#ddlPayMode").val();
                    var serviceCode = $("#ddlVehExpHead").val();
                    var account = $("#txtAccountCode").val();
                    var amount = $("#txtAmount").val();
                    var narration = $("#txtNaration").val();

                    if (PayModeCode == "0") {
                        $("#ddlPayMode").css("border-color", "red");
                        count++;
                    }

                    if (serviceCode == "0" || serviceCode == undefined) {
                        $("#ddlVehExpHead").css("border-color", "red");
                        count++;
                    }

                    if (narration == "" || narration == undefined) {
                        $("#txtNaration").css("border-color", "red");
                        count++;
                    }

                    if (amount == "" || amount == undefined) {
                        $("#txtAmount").css("border-color", "red");
                        count++;
                    }

                    if (count == 0) {
                        return true;
                    }
                    return false;
                }

                function PageValidation() {


                    var count = 0;

                    //if ($("#ddlIncType").val() == '0' || $("#ddlIncType").val() == null) {
                    //    $("#ddlIncType").css("border-color", "red");
                    //    $("#ddlIncType").focus();
                    //    count++;
                    //}
                    if ($("#txtSaleInvoiceNo").val() == '' || $("#txtSaleInvoiceNo").val() == null) {
                        $("#txtSaleInvoiceNo").css("border-color", "red");
                        $("#txtSaleInvoiceNo").focus();
                        count++;
                    }

                    var row = $('#tblInstrument >tbody  >tr').length;

                    if (count > 0 || row == 0) {

                        $("#lblMessage").html("Please fill the Required feilds");
                        $("#section-message").modal("show");
                        return false;
                    }
                    else {
                        return true;
                    }

                }

                $("#btnSave").click(function () {
                    debugger;
                    //if (ValidateDetail()) {
                    //    $("#lblMessage").html("Please fill the Required feilds");
                    //    $("#section-message").modal("show");
                    //    return false;

                    //}
                    if (!PageValidation()) {
                        return false;
                    }

                    $("#section-confirm").modal("show");
                })

                function SaveMasterEnquiry() {

                    var dto = {};


                    dto.DealerCode = "@Session["DealerCode"].ToString()";
                    dto.ReceiptNo = $("#txtReceiptNo").val();
                    dto.ReceiptDate = $("#txtReceiptDate").val();
                    dto.TransType = $("#ddlIncType").val();
                    dto.InvoiceNo = $("#txtSaleInvoiceNo").val();
                    dto.InvoiceDate = $("#txtSaleInvoiceDate").val();
                    dto.PRBNo = $("#txtRefDocNo").val();
                    //dto.InvTypeCode = $("#txtServeQty").val();
                    //dto.InvSubTypeCode = $("#txtTotalAmount").val();
                    dto.CusCode = $("#hdnCusCode").val();
                    dto.EmpCode = $("#hdnEmpCode").val();
                    dto.EmpDesc = $("#txtSalesPerson").val();
                    dto.ProdDesc = $("#txtVehicle").val();
                    dto.EngineNo = $("#txtEngineNo").val();
                    dto.ChasisNo = $("#txtChassisNo").val();
                    dto.Remarks = $("#txtRemarks").val();
                    dto.FormName = "Advance/Service charges";


                    $.ajax({
                        //contentType: 'application/json; charset=utf-8',
                        dataType: "json",
                        async: true,
                        type: 'POST',
                        url: '@Url.Content("~/SaleOrder/Insert_ReceiptMaster")',
                        data: dto,
                        success: function (data) {

                            debugger
                            if (data) {
                                debugger
                                if (data.Success == true) {

                                    saveReceiptDetail();

                                }
                                else {
                                    $("#section-confirm").modal("hide")
                                    $("#modalMessage").css("background-color", "#e46457");
                                    $("#lblMessage").text(data.Message)
                                    $("#section-message").modal('show');
                                }
                            }
                        },
                        complete: function () {

                        },
                        error: function (data) {
                            $("#section-confirm").modal("hide")
                            $("#modalMessage").css("background-color", "#e46457");
                            $("#lblMessage").text(data.Message)
                            $("#section-message").modal('show');
                        }
                    });
                }

                function insertRecord() {
                    var obj = [];

                    $("#tblInstrument tbody tr").each(function () {
                        var dto = {};
                        dto.ReceiptDate = $("#txtReceiptDate").val();
                        dto.InstrumentTypeCode = $(this).closest('tr').find('#hdnPayModeCode').val();
                        dto.InstrumentNo = $(this).closest('tr').find('#lblInsNo').text();
                        dto.InstrumentDate = $(this).closest('tr').find('#lblInsDate').text().trim();
                        dto.BankCode = $(this).closest('tr').find('#hdnBankCode').val();
                        dto.Branch = $(this).closest('tr').find('#lblBranch').text().trim();
                        dto.CityCode = $(this).closest('tr').find('#hdnCityCode').val();
                        dto.VehExpCode = $(this).closest('tr').find('#hdnServiceCode').val();
                        dto.ServicesAccountCode = $(this).closest('tr').find('#lblAccount').text().trim();
                        dto.ReceiptAmount = $(this).closest('tr').find('#lblAmount').text().trim();
                        dto.CusCode = $("#hdnCusCode").val();
                        dto.Narration = $(this).closest('tr').find('#lblNaration').text().trim();
                        dto.DealerCode = "@Session["DealerCode"].ToString()";
                        obj.push(dto);
                    });

                    return obj;
                }

                function saveReceiptDetail() {

                    var objects = [];
                    debugger
                    objects = JSON.stringify({ 'objects': insertRecord() });

                    $.ajax({
                        contentType: 'application/json; charset=utf-8',
                        dataType: "json",
                        //async: true,
                        type: 'POST',
                        url: '@Url.Content("~/SaleOrder/Insert_ReceiptDetail")',
                        data: objects,
                        success: function (data) {

                            if (data.Success == true) {
                                saveAccTrans();
                            }
                            else {
                                $("#section-confirm").modal("hide")
                                $("#modalMessage").css("background-color", "#e46457");
                                $("#lblMessage").text(data.Message)
                                $("#section-message").modal('show');

                            }
                        },
                        complete: function () {
                        },
                        error: function (data) {
                            $("#section-confirm").modal("hide")
                            $("#modalMessage").css("background-color", "#e46457");
                            $("#lblMessage").text(data.Message)
                            $("#section-message").modal('show');
                        }

                    });

                }

                function insertAccRecord() {
                    var obj = [];

                    $("#tblInstrument tbody tr").each(function () {
                        var dto = {};

                        dto.DealerCode = "@Session["DealerCode"].ToString()";
                        dto.TransactionDate = $("#txtReceiptDate").val();
                        dto.CusCode = $("#hdnCusCode").val();
                        dto.InvType = $(this).closest('tr').find('#hdnPayModeCode').val();
                        dto.TrType = $(this).closest('tr').find('#hdnServiceCode').val();
                        dto.Narration = $(this).closest('tr').find('#lblNaration').text().trim();
                        dto.Reference = $("#txtSaleInvoiceNo").val();
                        dto.Credit = $(this).closest('tr').find('#lblAmount').text().trim();

                        obj.push(dto);
                    });

                    return obj;
                }

                function saveAccTrans() {

                    var objects = [];

                    objects = JSON.stringify({ 'objects': insertAccRecord() });

                    $.ajax({
                        contentType: 'application/json; charset=utf-8',
                        dataType: "json",
                        //async: true,
                        type: 'POST',
                        url: '@Url.Content("~/SaleOrder/Insert_AccountTrans")',
                        data: objects,
                        success: function (data) {

                            if (data) {
                                if (data.Success == true) {
                                    $("#section-confirm").modal("hide")
                                    $("#modalMessage").css("background-color", "#64c344");
                                    $("#lblMessage").text(data.Message)
                                    $("#section-message").modal('show');
                                }
                            }
                            else {
                                $("#section-confirm").modal("hide")
                                $("#modalMessage").css("background-color", "#e46457");
                                $("#lblMessage").text(data.Message)
                                $("#section-message").modal('show');

                            }
                        },
                        complete: function () {

                            location.reload();
                        },
                        error: function (data) {
                            $("#section-confirm").modal("hide")
                            $("#modalMessage").css("background-color", "#e46457");
                            $("#lblMessage").text(data.Message)
                            $("#section-message").modal('show');
                        }

                    });

                }


                RevClickDetail = function (ReceiptNo, ReceiptDate, InvoiceNo, InvoiceDate, PRBNo, EmpCode, EmpName, EngineNo, ChasisNo, CusCode, ProdDesc, Remarks, CusDesc, TransType,SalePrice,TotalAmount,Discount,MarketRate) {

                    $('#txtReceiptNo').val(ReceiptNo);
                    $('#txtReceiptDate').val(ReceiptDate);
                    $('#ddlIncType').val(TransType);
                    $('#txtSaleInvoiceNo').val(InvoiceNo);
                    $('#txtSaleInvoiceDate').val(InvoiceDate);
                    $('#hdnEmpCode').val(EmpCode);
                    $('#txtSalesPerson').val(EmpName);
                    $('#txtEngineNo').val(EngineNo);
                    $('#txtChassisNo').val(ChasisNo);
                    $('#hdnCusCode').val(CusCode);
                    $('#txtCustomer').val(CusDesc);
                    $('#txtVehicle').val(ProdDesc);
                    $('#txtRemarks').val(Remarks);
                    $('#txtRefDocNo').val(PRBNo);
                    debugger
                    $('#txtSalePrice').val(SalePrice);
                    $('#txtTotal').val(TotalAmount);
                    $('#txtDiscount').val(Discount);
                    $('#txtMarketRate').val(MarketRate);

                    getSaleInvoiceDetail(InvoiceNo, ChasisNo)

                    getVehicleData(ReceiptNo);

                    $("#ReceiptModal").modal("hide");
                }

                function getVehicleData(id) {
                    var rowCount = 1;
                    var dataCount = 1;
                    var SNo = 1;
                    var total = 0;

                    var leadId = id;
                    if (leadId != "0") {
                        $.ajax({
                            dataType: "json",
                            async: true,
                            type: 'GET',
                            url: '@Url.Content("~/SaleOrder/Select_ReceiptDetail")',
                            data: { 'EnquiryId': leadId },
                            success: function (data) {
                                ;
                                if (data.Success == true) {
                                    var item = JSON.parse(data.Response)
                                    $("#tblInstrument tbody tr").remove()
                                    //ProductDetail
                                    if (item.length > 0) {
                                        $.each(item, function (value, item) {
                                            total = total + parseFloat(item.ReceiptAmount);
                                            debugger
                                            $("#tblInstrument tbody").append('<tr id="fixedRow' + (rowCount++) + '" data-tr-count="' + (dataCount++) + '">' +
                                                                    '<td>' + SNo++ + '</td>' +
                                                                    '<td> <label id="lblPayMode">' + item.PayModeDesc + ' </label><input type="hidden" id="hdnPayModeCode" value="' + item.InstrumentTypeCode + '"/></td>' +
                                                                    '<td> <label id="lblInsNo">' + item.InstrumentNo + ' </label>' +
                                                                    '</td><td> <label id="lblInsDate">' + item.InstrumentDate + ' </label></td>' +

                                                                    '<td> <label id="lblBank">' + item.BankDesc + ' </label><input type="hidden" id="hdnBankCode" value="' + item.BankCode + '"/></td>' +
                                                                    '<td> <label id="lblBranch">' + item.Branch + ' </label></td>' +
                                                                    '<td> <label id="lblCity">' + item.CityDesc + ' </label><input type="hidden" id="hdnCityCode" value="' + item.CityCode + '"/></td>' +

                                                                    '<td> <label id="lblService">' + item.VehExpDesc + ' </label><input type="hidden" id="hdnServiceCode" value="' + item.VehExpCode + '"/></td>' +
                                                                    //'<td> <label id="lblAccount">' + item.ServicesAccountCode + ' </label>' +
                                                                    '</td><td> <label id="lblAmount">' + item.ReceiptAmount + ' </label>' +
                                                                    '</td><td> <label id="lblNaration">' + item.Narration + '</label>' +
                                                                    '</td><td style="text-align:center;">' +
                                                                     '<a class="selectItem"><i class="fa fa-edit" style="color:blue"></i></a>&nbsp;&nbsp;|&nbsp;&nbsp;<a class= "deleteItem" style="color:blue" ><i class="fa fa-trash"></i></a></td>' +
                                                                    '</td></tr>'



                                                                   );

                                        });


                                    }
                                }
                            },
                            complete: function () {
                                $('#txtTAmount').val(total);
                            },
                        });

                    }

                }

                $("table#tblInstrument").on('click', '.deleteItem', function () {
                    rIndex = $(this).closest('tr');
                    index = $(this).closest('tr')[0].rowIndex;
                    $(this).closest('tr').remove();

                });
                $("#btnDelete").click(function () {
                    $("#section-confirm-Delete").modal("show");
                })

                function DeleteEnquiry() {
                    var leadId = $("#txtReceiptNo").val();

                    $.ajax({
                        dataType: "json",
                        async: true,
                        type: 'POST',
                        url: '@Url.Content("~/SaleOrder/Delete_Receipt")',
                        data: { 'EnquiryId': leadId },
                        success: function (data) {
                            if (data) {
                                if (data.success == true) {
                                    $("#section-confirm-Delete").modal("hide")
                                    $("#modalMessage").css("background-color", "#64c344");
                                    $("#lblMessage").text(data.Message)
                                    $("#section-message").modal('show');
                                    setTimeout(function () {
                                        $('#section-message').modal('hide')
                                    }, 4000);
                                } else {
                                    $("#section-confirm-Delete").modal("hide")
                                    $("#modalMessage").css("background-color", "#e46457");
                                    $("#lblMessage").text(data.Message)
                                    $("#section-message").modal('show');
                                    setTimeout(function () {
                                        $('#section-message').modal('hide')
                                    }, 4000);

                                }
                            }
                        },
                        complete: function () {

                        },
                    });

                }
                var Vouchno;

                function GetVoucherNo() {
                    debugger
                    var leadId = $("#txtReceiptNo").val();
                   
                    $.ajax({
                        dataType: "json",
                        async: true,
                        type: 'GET',
                        url: '@Url.Content("~/SaleOrder/Select_VehicleReceiptVoucherNo")',
                        data: { 'EnquiryId': leadId },
                        success: function (data) {
                            if (data) {
                                debugger
                                var item = JSON.parse(data.Response)
                                Vouchno = item.Vouchno;
                            }
                        },
                        complete: function () {

                        },
                    });

                }

                $("#btnPrint").click(function () {

                    var baseurl = '@Url.Action("AdvSerCharExport")';
                    var url = baseurl + '?EnquiryId=' + $('#txtReceiptNo').val() + '&DealerCode=@Session["DealerCode"].ToString()';
                    //window.location.href = url;
                    window.open(url, '_blank');

                })
                $("#btnFForm").click(function () {

                    var baseurl = '@Url.Action("FFormExport")';
                    var url = baseurl + '?EnquiryId=' + $('#txtChassisNo').val() + '&DealerCode=@Session["DealerCode"].ToString()';
                    //window.location.href = url;
                    window.open(url, '_blank');

                })
                $("#btnVoucher").click(function () {
                    GetVoucherNo();
                    var ChassisNo = $("#txtChassisNo").val();
                    var baseurl = '@Url.Action("VoucherMain","Voucher")';
                    debugger
                    var url = baseurl + '?leadId=' + $('#txtReceiptNo').val() + '&type=ASC' + '&VouchNo=' + Vouchno + '&ChassisNo=' + ChassisNo;
                    window.open(url, "_blank", "width=1000,height=600");
                    //window.location.href = baseurl;
                    //window.open(baseurl, '_blank');

                })
            </script>


